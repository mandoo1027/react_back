<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="COM">

	<!-- 공통코드 조회 -->
	<select id="selectCmmnCode" parameterType="hashmap" resultType="hashmap">
		<![CDATA[
            SELECT A.*
            FROM (
                SELECT A.GRP_CODE
                     , A.GRP_NAME
                FROM cmmn_code A
            ]]>
		<where>
			<if test="grpCode != null and grpCode != ''">
				AND A.GRP_CODE LIKE CONCAT(#{grpCode}, '%')
			</if>
			<if test="grpName != null and grpName != ''">
				AND A.GRP_NAME LIKE CONCAT('%', #{grpName}, '%')
			</if>
			<if test="code != null and code != ''">
				AND A.CODE LIKE CONCAT(#{code}, '%')
			</if>
			<if test="name != null and name != ''">
				AND A.NAME LIKE CONCAT('%', #{name}, '%')
			</if>
			<if test="etcCodeOrName != null and etcCodeOrName != ''">
				AND (
				A.CODE2 LIKE CONCAT('%', #{etcCodeOrName}, '%')
				OR A.NAME2 LIKE CONCAT('%', #{etcCodeOrName}, '%')
				OR A.CODE3 LIKE CONCAT('%', #{etcCodeOrName}, '%')
				OR A.NAME3 LIKE CONCAT('%', #{etcCodeOrName}, '%')
				OR A.CODE4 LIKE CONCAT('%', #{etcCodeOrName}, '%')
				OR A.NAME4 LIKE CONCAT('%', #{etcCodeOrName}, '%')
				OR A.CODE5 LIKE CONCAT('%', #{etcCodeOrName}, '%')
				)
			</if>
		</where>
		GROUP BY A.GRP_CODE, A.GRP_NAME
		ORDER BY A.GRP_CODE, A.GRP_NAME
		) A
	</select>
	<!-- 공통코드 조회 -->
	<select id="selectCmmnGrpCode" parameterType="hashmap" resultType="hashmap">
		<![CDATA[
            SELECT A.*
            FROM (
                SELECT A.GRP_CODE
                     , A.GRP_NAME
                     , A.USE_YN
                     , A.MEMO
                FROM cmmn_grp_code A
            ]]>
		<where>
			<if test="grpCode != null and grpCode != ''">
				AND A.GRP_CODE LIKE CONCAT(#{grpCode}, '%')
			</if>
			<if test="grpName != null and grpName != ''">
				AND A.GRP_NAME LIKE CONCAT('%', #{grpName}, '%')
			</if>
			<if test="useYn != null and useYn != ''">
				AND A.USE_YN = #{useYn}
			</if>

		</where>
		ORDER BY A.GRP_CODE, A.GRP_NAME
		) A
	</select>

	<!-- 공통코드 상세 조회 -->
	<select id="selectCmmnCodeDetail" parameterType="hashmap" resultType="hashmap">
		<![CDATA[
            SELECT A.*
            FROM (
                SELECT A.GRP_CODE
                     , A.GRP_NAME
                     , A.CODE
                     , A.NAME
                     , A.CODE2
                     , A.NAME2
                     , A.CODE3
                     , A.NAME3
                     , A.CODE4
                     , A.NAME4
                     , A.CODE5
                     , A.NAME5
                     , A.SEQ
                     , A.USE_YN
                FROM cmmn_code A
            ]]>
		<where>
			<if test="grpCode != null and grpCode != ''">
				AND A.GRP_CODE = #{grpCode}
			</if>
		</where>
		ORDER BY A.GRP_CODE, A.SEQ, A.CODE
		<if test="startNum >= 0 and endNum != 0">
			LIMIT #{startNum}, #{endNum}
		</if>
		) A
	</select>

	<insert id="insertCmmnCode" parameterType="hashmap">
		INSERT INTO teo.cmmn_code (
		grp_code, grp_name, code, name,
		code2, name2, code3, name3,
		code4, name4, code5, name5,
		seq, use_yn, rgtr_user_id, rgtr_dt,
		last_user_id, last_chg_dt
		) VALUES (
		#{grpCode}, #{grpName}, #{code}, #{name},
		#{code2}, #{name2}, #{code3}, #{name3},
		#{code4}, #{name4}, #{code5}, #{name5},
		#{seq}, #{useYn}, #{rgtrUserId},DATE_FORMAT(NOW(), '%Y%m%d%H%i%s'),
		#{lastUserId}, DATE_FORMAT(NOW(), '%Y%m%d%H%i%s')
		)
	</insert>

	<update id="updateCmmnCode" parameterType="hashmap">
		UPDATE cmmn_code
		<set>
			<if test="grpName != null and grpName != ''">grp_name = #{grpName},</if>
			<if test="name != null and name != ''">name = #{name},</if>
			<if test="code2 != null and code2 != ''">code2 = #{code2},</if>
			<if test="name2 != null and name2 != ''">name2 = #{name2},</if>
			<if test="code3 != null and code3 != ''">code3 = #{code3},</if>
			<if test="name3 != null and name3 != ''">name3 = #{name3},</if>
			<if test="code4 != null and code4 != ''">code4 = #{code4},</if>
			<if test="name4 != null and name4 != ''">name4 = #{name4},</if>
			<if test="code5 != null and code5 != ''">code5 = #{code5},</if>
			<if test="name5 != null and name5 != ''">name5 = #{name5},</if>
			<if test="seq != null">seq = #{seq},</if>
			<if test="useYn != null and useYn != ''">useYn = #{useYn},</if>
			<if test="rgtrUserId != null and rgtrUserId != ''">rgtr_user_id = #{rgtrUserId},</if>
			<if test="rgtrDt != null">rgtr_dt = #{rgtrDt},</if>
			<if test="lastUserId != null and lastUserId != ''">last_user_id = #{lastUserId},</if>
			<if test="lastChgDt != null">last_chg_dt = #{lastChgDt}</if>
		</set>
		WHERE grp_code = #{grpCode}
		AND code = #{code}
	</update>
	<delete id="deleteCmmnCode" parameterType="hashmap">
		DELETE FROM cmmn_code
		WHERE grp_code = #{grpCode}
		AND code = #{code}
	</delete>
</mapper>